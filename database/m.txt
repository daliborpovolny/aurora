CREATE TABLE Users (
    user_id INT PRIMARY KEY AUTO_INCREMENT,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    first_name VARCHAR(100) NOT NULL,
    last_name VARCHAR(100) NOT NULL,
    date_of_birth DATE,
    gender VARCHAR(20),
    address TEXT,
    phone_number VARCHAR(20),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    user_type ENUM('student', 'teacher', 'parent', 'admin') NOT NULL
);



CREATE TABLE Messages (
  message_id INT PRIMARY KEY AUTO_INCREMENT,
  sender_id INT NOT NULL,
  subject VARCHAR(255),
  content TEXT NOT NULL,
  sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (sender_id) REFERENCES Users(user_id)
);

CREATE TABLE Groups (
  group_id INT PRIMARY KEY AUTO_INCREMENT,
  group_name VARCHAR(100) NOT NULL,
  description TEXT,
  group_type ENUM('class', 'interest', 'other') NOT NULL
);

CREATE TABLE GroupMembers (
  group_id INT,
  user_id INT,
  PRIMARY KEY (group_id, user_id),
  FOREIGN KEY (group_id) REFERENCES Groups(group_id),
  FOREIGN KEY (user_id) REFERENCES Users(user_id)
);


CREATE TABLE MessageGroupRecipients (
  message_id INT,
  group_id INT,
  PRIMARY KEY (message_id, group_id),
  FOREIGN KEY (message_id) REFERENCES Messages(message_id),
  FOREIGN KEY (group_id) REFERENCES Groups(group_id)
);